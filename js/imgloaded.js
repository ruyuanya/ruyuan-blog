function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);i=i.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}var ProgressiveLoad=(()=>_createClass(function e(t,i){_classCallCheck(this,e),this.smallSrc=t,this.largeSrc=i,this.initScrollListener(),this.initTpl()},[{key:"initScrollListener",value:function(){var t=this;window.addEventListener("scroll",function(){var e=Math.min(window.scrollY/window.innerHeight,1);t.container.style.setProperty("--process",e)})}},{key:"initTpl",value:function(){this.container=document.createElement("div"),this.smallStage=document.createElement("div"),this.largeStage=document.createElement("div"),this.video=document.createElement("div"),this.smallImg=new Image,this.largeImg=new Image,this.container.className="pl-container",this.container.style.setProperty("--process",0),this.smallStage.className="pl-img pl-blur",this.largeStage.className="pl-img",this.video.className="pl-video",this.container.appendChild(this.smallStage),this.container.appendChild(this.largeStage),this.container.appendChild(this.video),this.smallImg.onload=this._onSmallLoaded.bind(this),this.largeImg.onload=this._onLargeLoaded.bind(this)}},{key:"progressiveLoad",value:function(){this.smallImg.src=this.smallSrc,this.largeImg.src=this.largeSrc}},{key:"_onLargeLoaded",value:function(){this.largeStage.classList.add("pl-visible"),this.largeStage.style.backgroundImage="url('".concat(this.largeSrc,"')")}},{key:"_onSmallLoaded",value:function(){this.smallStage.classList.add("pl-visible"),this.smallStage.style.backgroundImage="url('".concat(this.smallSrc,"')")}}]))(),executeLoad=function(e,t){console.log("执行渐进背景替换");var i=window.matchMedia("(max-width: 767px)").matches,i=new ProgressiveLoad(i?e.mobileSmallSrc:e.smallSrc,i?e.mobileLargeSrc:e.largeSrc);t.children[0]&&t.insertBefore(i.container,t.children[0]),i.progressiveLoad()},config={smallSrc:"/images/backgroundimg/m-big2.jpg",largeSrc:"/images/backgroundimg/m-big1.jpg",mobileSmallSrc:"/images/backgroundimg/m-small2.jpg",mobileLargeSrc:"/images/backgroundimg/m-small1.jpg",enableRoutes:["/"]};function initProgressiveLoad(e){var t=document.querySelector(".pl-container"),t=(t&&t.remove(),document.getElementById("page-header"));t&&t.classList.contains("full_page")&&executeLoad(e,t)}function onPJAXComplete(e){var t=document.getElementById("page-header");t&&t.classList.contains("full_page")&&initProgressiveLoad(e)}document.addEventListener("DOMContentLoaded",function(){initProgressiveLoad(config)}),document.addEventListener("pjax:complete",function(){onPJAXComplete(config)});